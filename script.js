document.addEventListener("DOMContentLoaded", () => {
  const lang = localStorage.getItem('appLanguage') || 'en';

  const translations = {
    en: {
      character: 'Character',
      upgrade: 'Upgrade',
      item: 'Item',
      setting: 'Setting',
      unlock: 'Unlock',
      yourPlan: 'Your plan',
      free: 'FREE',
    },
    hi: {
      character: 'चरित्र',
      upgrade: 'अपग्रेड करें',
      item: 'आइटम',
      setting: 'सेटिंग',
      unlock: 'अनलॉक करें',
      yourPlan: 'आपकी योजना',
      free: 'नि:शुल्क',
    },
    jp: {
      character: 'キャラクター',
      upgrade: 'アップグレード',
      item: 'アイテム',
      setting: '設定',
      unlock: 'アンロック',
      yourPlan: 'あなたのプラン',
      free: '無料',
    }
  };

  const textKeys = {
    '.title': 'character',
    '.upgrade': 'upgrade',
    '.highlight': 'free',
    '.setting-title': 'setting',
    '.item-title': 'item',
    '.plan-label': 'yourPlan',
    '.unlock-button': 'unlock',
    '.button-upgrade': 'upgrade',
  };

  for (let selector in textKeys) {
    const el = document.querySelector(selector);
    if (el && translations[lang][textKeys[selector]]) {
      el.textContent = translations[lang][textKeys[selector]];
    }
  }

  // Dropdown handling on setting.html
  const languageSelect = document.getElementById('languageSelect');
  if (languageSelect) {
    languageSelect.value = lang;
    languageSelect.addEventListener('change', () => {
      localStorage.setItem('appLanguage', languageSelect.value);
      location.reload();
    });
  }

  // Footer navigation active class
  const page = location.pathname.split("/").pop();
  document.querySelectorAll('.footer a.circle').forEach(link => {
    if (link.getAttribute('href') === page) {
      link.classList.add('active');
    } else {
      link.classList.remove('active');
    }
  });
});
